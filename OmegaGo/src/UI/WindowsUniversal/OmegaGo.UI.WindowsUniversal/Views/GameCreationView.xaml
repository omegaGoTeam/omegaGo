<views:TransparencyViewBase
    x:Class="OmegaGo.UI.WindowsUniversal.Views.GameCreationView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:views="using:OmegaGo.UI.WindowsUniversal.Views"
    xmlns:viewModels="using:OmegaGo.UI.ViewModels"
    xmlns:userControls="using:OmegaGo.UI.WindowsUniversal.UserControls"
    xmlns:navigation="using:OmegaGo.UI.WindowsUniversal.UserControls.Navigation"
    mc:Ignorable="d"
    d:DataContext="{d:DesignInstance viewModels:GameCreationViewModel, IsDesignTimeCreatable=False}">
    <Page.Transitions>
        <TransitionCollection>
            <NavigationThemeTransition>
                <ContinuumNavigationTransitionInfo />
            </NavigationThemeTransition>
        </TransitionCollection>
    </Page.Transitions>

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}" HorizontalAlignment="Center">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        
        <navigation:TitleControl Text="New Game" 
                   HorizontalAlignment="Center"
                   Margin="0,20,0,0"
                   Grid.Row="0" />


        <Grid x:Name="GameSettingsGrid"
              HorizontalAlignment="Center"
              Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition x:Name="FirstColumn" Width="Auto" />
                <ColumnDefinition x:Name="SecondColumn" Width="Auto" />
                <ColumnDefinition x:Name="ThirdColumn" Width="Auto" />
            </Grid.ColumnDefinitions>

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <TextBlock Text="Server" Grid.Column="0"
                       Grid.Row="0" HorizontalAlignment="Right"
                       FontSize="22"
                       Margin="5"
                       VerticalAlignment="Center"></TextBlock>
            <ComboBox Grid.Column="1" Grid.Row="0" Margin="5" Width="125" MinWidth="{Binding ElementName=FirstColumn, Path=ActualWidth}" SelectedItem="{Binding Server, Mode=TwoWay}" IsEnabled="False">
                <x:String>Local Game</x:String>
                <x:String>IGS</x:String>
                <x:String>KGS</x:String>
            </ComboBox>

            <TextBlock Text="{x:Bind Localizer.BoardSize}" Grid.Column="0" Grid.Row="1" 
                       HorizontalAlignment="Right" VerticalAlignment="Center" 
                       FontSize="22" Margin="5" />
            <ComboBox Grid.Column="1" Grid.Row="1" Margin="5" Width="125" MinWidth="{Binding ElementName=FirstColumn, Path=ActualWidth}"
                      ItemsSource="{Binding Path=BoardSizes}"
                      SelectedItem="{Binding Path=SelectedGameBoardSize, Mode=TwoWay}">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock>
                            <Run Text="{Binding Width}" FontWeight="SemiBold" />
                            <Run Text=" x " />
                            <Run Text="{Binding Height}" FontWeight="SemiBold" />
                        </TextBlock>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <Button Grid.Column="2" Grid.Row="1" 
                    HorizontalAlignment="Stretch"
                    Content="Custom...">
                <Button.Flyout>
                    <Flyout Placement="Right">
                        <StackPanel>
                            <TextBlock Text="Width: "/>
                            <TextBox InputScope="Number" Name="TbCustomWidth" Text="{Binding CustomWidth, Mode=TwoWay}"/>
                            <TextBlock Text="Height: "/>
                            <TextBox InputScope="Number" Name="TbCustomHeight" Text="{Binding CustomHeight, Mode=TwoWay}"/>
                        </StackPanel>
                    </Flyout>
                </Button.Flyout>
            </Button>

            <TextBlock Text="{x:Bind Localizer.Rules}" Grid.Column="0" Grid.Row="2" 
                       HorizontalAlignment="Right" 
                       VerticalAlignment="Center" 
                       FontSize="22" Margin="5" />
            <ComboBox Grid.Column="1" Grid.Row="2" Margin="5" HorizontalAlignment="Stretch"
                      ItemsSource="{Binding Rulesets}"
                      IsEnabled="{Binding RulesetCanBeSelected}"
                      SelectedItem="{Binding SelectedRuleset, Mode=TwoWay}">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Converter={StaticResource ConcreteEnumLocalizingConverter}}" />
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <TextBlock Text="Black" Grid.Column="0" Grid.Row="3" 
                       HorizontalAlignment="Right" 
                       VerticalAlignment="Center" 
                       FontSize="22" Margin="5" />
            <ComboBox Grid.Column="1" Grid.Row="3" Margin="5" HorizontalAlignment="Stretch"
                      ItemsSource="{Binding Path=PossiblePlayers}"
                      SelectedItem="{Binding BlackPlayer, Mode=TwoWay}"/>
            <Button Grid.Column="2" Grid.Row="3" 
                    Content="More..."
                    HorizontalAlignment="Stretch">
                <Button.Flyout>
                    <Flyout Placement="Right">
                        <StackPanel>
                            <userControls:PlayerSettingsControl ViewModel="{x:Bind VM.BlackPlayerSettings}" />
                        </StackPanel>
                    </Flyout>
                </Button.Flyout>
            </Button>

            <TextBlock Visibility="{x:Bind VM.RulesetCanBeSelected}"
                        Text="White" Grid.Column="0" Grid.Row="4" 
                       HorizontalAlignment="Right" 
                       VerticalAlignment="Center" 
                       FontSize="22" Margin="5" />
            <ComboBox Visibility="{x:Bind VM.RulesetCanBeSelected}" Grid.Column="1" Grid.Row="4" Margin="5" HorizontalAlignment="Stretch"
                      ItemsSource="{Binding Path=PossiblePlayers}"
                      SelectedItem="{Binding WhitePlayer, Mode=TwoWay}"/>
            <Button Visibility="{x:Bind VM.RulesetCanBeSelected}" 
                    Grid.Column="2" Grid.Row="4" 
                    Content="More..."
                    HorizontalAlignment="Stretch">
                <Button.Flyout>
                    <Flyout Placement="Right">
                        <userControls:PlayerSettingsControl ViewModel="{x:Bind VM.WhitePlayerSettings}" />
                    </Flyout>
                </Button.Flyout>
            </Button>

            <TextBlock Text="{x:Bind Localizer.WhiteHandicap}" Grid.Column="0" Grid.Row="5" 
                       HorizontalAlignment="Right" VerticalAlignment="Center" 
                       FontSize="22" Margin="5" />

            <Slider Minimum="0" Maximum="9" StepFrequency="1" SmallChange="1" LargeChange="1" Value="{Binding Handicap, Mode=TwoWay}" IsEnabled="{x:Bind VM.RulesetCanBeSelected}" Grid.Column="1" Grid.Row="5" HorizontalAlignment="Stretch"  Margin="5" />
            <TextBlock Text="{Binding Handicap}" HorizontalAlignment="Center" Margin="2" Grid.Row="5" Grid.Column="1" VerticalAlignment="Bottom" />
            <TextBlock Text="Time Control" Grid.Column="0" Grid.Row="6" 
                       HorizontalAlignment="Right" 
                       VerticalAlignment="Center" 
                       FontSize="22" Margin="5" />
            <TextBlock Grid.Column="1" Grid.Row="6" Margin="5" HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Text="{x:Bind VM.TimeControl.OneLineDescription, Mode=OneWay}">
            </TextBlock>
            <Button Grid.Column="2" Grid.Row="6" 
                    HorizontalAlignment="Stretch"
                    Content="Change...">
                <Button.Flyout>
                    <Flyout  Placement="Right" >
                        <StackPanel Width="300">
                            <ComboBox  ItemsSource="{x:Bind VM.TimeControlStyles}" SelectedItem="{x:Bind VM.TimeControl.Style, Mode=TwoWay}">
                            </ComboBox>
                            <StackPanel Visibility="{x:Bind VM.TimeControl.IsAbsoluteTiming, Mode=OneWay}">
                                <TextBlock TextWrapping="Wrap">
                                        <Run FontWeight="Bold">Absolute Timing.</Run> When a player's time elapses, that player loses immediately.
                                </TextBlock>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock VerticalAlignment="Center" Margin="0,0,10,0">Time:</TextBlock>
                                    <TextBox Text="{x:Bind VM.TimeControl.MainTime, Mode=TwoWay}" InputScope="Number" Width="30"></TextBox>
                                </StackPanel>
                            </StackPanel>
                            <StackPanel Visibility="{x:Bind VM.TimeControl.IsNoTiming, Mode=OneWay}">
                                <TextBlock TextWrapping="Wrap">
                                        <Run FontWeight="Bold">No Time Control.</Run> There is no time limit for either player.
                                </TextBlock>
                            </StackPanel>
                            <StackPanel Visibility="{x:Bind VM.TimeControl.IsCanadianTiming, Mode=OneWay}">
                                <TextBlock TextWrapping="Wrap">
                                        <Run FontWeight="Bold">Canadian Timing.</Run> Each player has a main time. When that elapses, the player enters their first <Run FontStyle="Italic">overtime period</Run> and must make a number of moves (usually 25) in a number of minutes (usually 10) or lose when the last minute elapses. If they make all the moves in time, then their remaining time is lost, but another overtime period begins for that player.
                                </TextBlock>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock VerticalAlignment="Center" Margin="0,0,10,0">Main time:</TextBlock>
                                    <TextBox Text="{x:Bind VM.TimeControl.MainTime, Mode=TwoWay}"  InputScope="Number" Width="30"></TextBox>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock VerticalAlignment="Center" Margin="0,0,10,0">Moves per period:</TextBlock>
                                    <TextBox Text="{x:Bind VM.TimeControl.StonesPerPeriod, Mode=TwoWay}"  InputScope="Number" Width="30"></TextBox>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock VerticalAlignment="Center" Margin="0,0,10,0">Minutes per period:</TextBlock>
                                    <TextBox Text="{x:Bind VM.TimeControl.OvertimeMinutes, Mode=TwoWay}"  InputScope="Number" Width="30"></TextBox>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Flyout>
                </Button.Flyout>
            </Button>

            <TextBlock Text="Compensation" Grid.Column="0" Grid.Row="7" 
                       HorizontalAlignment="Right" 
                       VerticalAlignment="Center" 
                       FontSize="22" Margin="5" />
            <TextBox IsEnabled="{Binding RulesetCanBeSelected}" Grid.Row="7" Margin="5" Grid.Column="1" x:Name="CompensationInput" InputScope="Number" Text="{Binding Compensation, Mode=TwoWay}" KeyDown="CompensationInput_KeyDown" />
            <Button Grid.Row="7" Grid.Column="2" 
                    Content="Set default"
                    HorizontalAlignment="Stretch"
                    Command="{x:Bind VM.SetDefaultCompensationCommand}"/>
            <Button Grid.Row="8" 
                    Command="{Binding Path=NavigateToGameCommand}"
                    HorizontalAlignment="Stretch"
                    Grid.Column="0"
                    Grid.ColumnSpan="3">
                <StackPanel Orientation="Horizontal">
                    <SymbolIcon Symbol="Street" Margin="0,2,0,0" />
                    <TextBlock Text="{x:Bind Localizer.Play}" Margin="10,0,0,0" />
                </StackPanel>
            </Button>
        </Grid>
    </Grid>
</views:TransparencyViewBase>
